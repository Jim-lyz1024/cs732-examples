# CS732 examples - Lecture 03 - Example 22 - Service workers
This project contains a clone of the project in [Example 21](../example-21-react-express), but configured with a service worker to allow some offline functionality. The backend code is identical to Example 21. The only change is in the frontend code.

In [index.js](./frontend/src/index.js), we're importing our `serviceWorkerRegistration` file and calling its `register()` function. This file is [serviceWorkerRegistration.js](./frontend/src/serviceWorkerRegistration.js).

In that file, we can see how we register a service worker, in the `register()` function on line 6. The most important functionality - registering the worker itself - is on lines 8 thru 10. The conditionals in the funtion are checking to make sure service workers are supported in the browser, and that we are running in production (it can get messy / difficult to test your app if your service worker is caching files all the time).

The service worker itself is located in [service-worker.js](./frontend/src/service-worker.js). It uses the [Workbox](https://developers.google.com/web/tools/workbox) packages to ease the creation of service workers and to enable integration with create-react-app.

The key features of this service worker are:

- Line 17: Will cause the service worker to "take over control" of all open browser tabs on this site once its active (otherwise the worker would only control tabs opened after the worker is activated).

- Line 23: Precaches all files generated by the create-react-app build process. If you don't have a reference to `self.__WB_MANIFEST` in your service worker, the CRA build will fail, letting you know you're missing this line.

- Line 29: This route forces all navigation requests to forward to `index.html`. This is necessary for React apps to function correctly.

- Line 62: This route will cache all image files the first time they're downloaded. It will employ a cache-first strategy to serve the images (i.e. it will check in the cache first, and serve them from the cache if they're there).
